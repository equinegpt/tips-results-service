{% extends "base.html" %}

{% block title %}{{ track_name }} - {{ meeting_date.strftime('%A %d %B %Y') if meeting_date else 'Results' }}{% endblock %}

{% block body %}
<main class="page-root">

  {# Back button #}
  <div style="margin-bottom: 16px;">
    <a href="/ui/overview?date_from={{ meeting_date.isoformat() }}&date_to={{ meeting_date.isoformat() }}" class="back-link">
      &larr; Back to Overview
    </a>
  </div>

  {# Social Card - designed to be screenshot-friendly #}
  <div class="social-card" id="social-card">
    <div class="social-header">
      <h1 class="social-track">{{ track_name }}</h1>
      <span class="social-date">{{ meeting_date.strftime('%A %dth %B') if meeting_date else '' }}</span>
    </div>

    <div class="social-tagline">
      Powered by AI. Backed by Punting Form.
    </div>

    <div class="social-races">
      {% for race in races %}
        <div class="social-race">
          <div class="social-race-header">
            <span class="social-race-label">Race {{ race.race_number }}:</span>
            {% if race.winner %}
              <span class="social-race-result">
                Winner: <span class="social-horse-num">#{{ race.winner.tab_number }}</span>
                <span class="social-horse-name {% if race.winner.is_ai_best %}social-horse-name--winner{% endif %}">{{ race.winner.horse_name }}</span>
                {% if race.winner.is_ai_best %}<span class="social-star">&#11088;</span>{% endif %}
              </span>
            {% else %}
              <span class="social-race-result social-race-result--miss">No winner tipped</span>
            {% endif %}
          </div>
          {% if race.winner and race.winner.reasoning %}
            <div class="social-reasoning">- {{ race.winner.reasoning }}</div>
          {% endif %}
          {% if race.danger %}
            <div class="social-danger">
              <span class="social-danger-label">Danger:</span>
              <span class="social-horse-num">#{{ race.danger.tab_number }}</span>
              <span class="social-horse-name {% if race.danger.placed %}social-horse-name--placed{% endif %}">{{ race.danger.horse_name }}</span>
              {% if race.danger.reasoning %}<span class="social-danger-reason">- {{ race.danger.reasoning }}</span>{% endif %}
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>

    {# Summary stats #}
    {% if summary %}
    <div class="social-summary">
      <div class="social-stat">
        <span class="social-stat-value">{{ summary.wins }}/{{ summary.tips }}</span>
        <span class="social-stat-label">Winners</span>
      </div>
      <div class="social-stat">
        <span class="social-stat-value">{{ summary.ai_best_wins }}</span>
        <span class="social-stat-label">AI Best Wins</span>
      </div>
      <div class="social-stat">
        <span class="social-stat-value">{{ summary.quinellas }}</span>
        <span class="social-stat-label">Quinellas</span>
      </div>
      <div class="social-stat">
        <span class="social-stat-value">{{ summary.trifectas }}</span>
        <span class="social-stat-label">Trifectas</span>
      </div>
      {% if summary.quaddie_hit %}
      <div class="social-stat social-stat--highlight">
        <span class="social-stat-value">&#10003;</span>
        <span class="social-stat-label">Quaddie</span>
      </div>
      {% endif %}
    </div>
    {% endif %}

    <div class="social-footer">
      <span class="social-footer-text">Stablfy AI Predictions | Smarter Insights Every Week</span>
      <span class="social-footer-url">www.stablfy.ai</span>
    </div>
  </div>

</main>

<style>
  .back-link {
    color: var(--accent);
    text-decoration: none;
    font-size: 14px;
  }
  .back-link:hover {
    text-decoration: underline;
  }

  /* Social Card Styles - dark theme matching the image */
  .social-card {
    background: #0a0a0a;
    border-radius: 12px;
    padding: 32px 40px;
    max-width: 700px;
    margin: 0 auto;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
  }

  .social-header {
    display: flex;
    align-items: baseline;
    gap: 16px;
    margin-bottom: 16px;
  }

  .social-track {
    font-size: 42px;
    font-weight: 700;
    color: #18cb96;
    margin: 0;
    line-height: 1.1;
  }

  .social-date {
    font-size: 28px;
    font-weight: 400;
    color: #ffffff;
  }

  .social-tagline {
    display: inline-block;
    background: #18cb96;
    color: #000;
    font-size: 14px;
    font-weight: 600;
    padding: 6px 16px;
    border-radius: 4px;
    margin-bottom: 24px;
  }

  .social-races {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 28px;
  }

  .social-race {
    line-height: 1.5;
  }

  .social-race-header {
    font-size: 16px;
    color: #fff;
  }

  .social-race-label {
    font-weight: 700;
    color: #fff;
  }

  .social-horse-num {
    color: #18cb96;
    font-weight: 600;
  }

  .social-horse-name {
    color: #18cb96;
    font-weight: 600;
  }

  .social-horse-name--winner {
    color: #18cb96;
  }

  .social-horse-name--placed {
    color: #9ca3af;
  }

  .social-star {
    margin-left: 4px;
    font-size: 14px;
  }

  .social-race-result--miss {
    color: #6b7280;
    font-style: italic;
  }

  .social-reasoning {
    font-size: 14px;
    color: #9ca3af;
    margin-top: 2px;
    margin-left: 0;
  }

  .social-danger {
    font-size: 14px;
    color: #9ca3af;
    margin-top: 4px;
  }

  .social-danger-label {
    font-weight: 600;
    color: #9ca3af;
  }

  .social-danger-reason {
    color: #6b7280;
  }

  .social-summary {
    display: flex;
    gap: 24px;
    padding: 20px 0;
    border-top: 1px solid #222;
    border-bottom: 1px solid #222;
    margin-bottom: 20px;
  }

  .social-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .social-stat-value {
    font-size: 24px;
    font-weight: 700;
    color: #fff;
  }

  .social-stat-label {
    font-size: 12px;
    color: #6b7280;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .social-stat--highlight .social-stat-value {
    color: #18cb96;
  }

  .social-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 13px;
    color: #6b7280;
    font-style: italic;
  }

  .social-footer-url {
    color: #18cb96;
    font-weight: 600;
    font-style: normal;
  }
</style>
{% endblock %}
